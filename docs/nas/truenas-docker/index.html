<!doctype html><html lang=en data-bs-theme=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload href=https://a4.zsl0621.cc/fonts/vendor/jost/jost-v4-latin-regular.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://a4.zsl0621.cc/fonts/vendor/jost/jost-v4-latin-500.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=https://a4.zsl0621.cc/fonts/vendor/jost/jost-v4-latin-700.woff2 as=font type=font/woff2 crossorigin><script src=/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg="></script><link rel=stylesheet href="/main.303ad1e76b9aec9f003f26dab6496c70040b06c73a698c9abaa7874ea605ff7d71b55aae2ff697f87bebb1aab6f375c67ab441ba34ef1d90a7b040ecd31a0298.css" integrity="sha512-MDrR52ua7J8APybatklscAQLBsc6aYyauqeHTqYF/31xtVquL/aX+Hvrsaq283XGerRBujTvHZCnsEDs0xoCmA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><base href=https://a4.zsl0621.cc/docs/nas/truenas-docker/><link rel=canonical href=https://a4.zsl0621.cc/docs/nas/truenas-docker/><title>TrueNAS Docker — ZSL Docs</title>
<meta name=description content="Congrats on setting up a new Doks project!"><link rel=icon href=/favicon.ico sizes=32x32><link rel=icon href=/favicon.svg type=image/svg+xml><link rel=apple-touch-icon href=/apple-touch-icon.png sizes=180x180 type=image/png><link rel=icon href=/favicon-192x192.png sizes=192x192 type=image/png><link rel=icon href=/favicon-512x512.png sizes=512x512 type=image/png><link rel=manifest href=/manifest.webmanifest><meta property="og:title" content="TrueNAS Docker"><meta property="og:description" content="前言 弄完基礎的檔案分享設定之後就是玩 docker，本文列出幾個常見的 docker-compose.yml 以便一鍵部屬。
還有個好消息，TrueNAS 在 2024/10 月版本將要放棄 k3s 改用 docker，這裡先放上幾個 docker-compose.yml，對相簿選擇障礙的可以看這裡。
Immich 版本：v1.108.0
這是最推薦的自架相簿，有些人可能會擔心他會破壞資料夾結構，尤其是攝影師，不過使用外部庫掛載就沒有這個問題。
由於現在還在非常積極發展的階段，建議掛載後加上:ro唯獨以免誤刪。
docker-compose.yml: 改掛載路徑就可用 name: immich services: immich-server: container_name: immich_server image: ghcr."><meta property="og:type" content="article"><meta property="og:url" content="https://a4.zsl0621.cc/docs/nas/truenas-docker/"><meta property="og:image" content="https://a4.zsl0621.cc/cover.png"><meta property="article:section" content="docs"><meta property="article:published_time" content="2024-07-28T22:52:57+08:00"><meta property="article:modified_time" content="2024-07-28T22:52:57+08:00"><meta property="og:site_name" content="My Docs"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://a4.zsl0621.cc/cover.png"><meta name=twitter:title content="TrueNAS Docker"><meta name=twitter:description content="前言 弄完基礎的檔案分享設定之後就是玩 docker，本文列出幾個常見的 docker-compose.yml 以便一鍵部屬。
還有個好消息，TrueNAS 在 2024/10 月版本將要放棄 k3s 改用 docker，這裡先放上幾個 docker-compose.yml，對相簿選擇障礙的可以看這裡。
Immich 版本：v1.108.0
這是最推薦的自架相簿，有些人可能會擔心他會破壞資料夾結構，尤其是攝影師，不過使用外部庫掛載就沒有這個問題。
由於現在還在非常積極發展的階段，建議掛載後加上:ro唯獨以免誤刪。
docker-compose.yml: 改掛載路徑就可用 name: immich services: immich-server: container_name: immich_server image: ghcr."><meta name=twitter:site content="@getdoks"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://a4.zsl0621.cc/","name":"Zsl Docs","position":1},{"@type":"ListItem","item":"https://a4.zsl0621.cc/docs/","name":"Docs","position":2},{"@type":"ListItem","item":"https://a4.zsl0621.cc/docs/nas/","name":"Nas","position":3},{"@type":"ListItem","name":"True Nas Docker","position":4}]}</script><script defer data-domain=getdoks.org src=https://plausible.io/js/script.js></script></head><body class="single section docs" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div class=sticky-top><header class="navbar navbar-expand-lg"><div class=container-fluid><a class="navbar-brand me-auto me-lg-3" href=/><span class=visually-hidden>ZSL Docs</span>
<svg class="doks-images-light-mode svg-inline svg-inline-custom svg-lightmode" height="100%" width="70" viewBox="0 0 682 190" fill="none"><path d="M.616001 187V.375992H88.424c21.163.0 38.912 3.925338 53.248 11.776008 14.507 7.68 25.429 18.5173 32.768 32.512C181.949 58.6587 185.704 75.0427 185.704 93.816c0 19.968-4.011 36.864-12.032 50.688-7.851 13.824-19.029 24.405-33.536 31.744C125.629 183.416 108.392 187 88.424 187H.616001zM38.248 157.304H81.512c22.357.0 38.912-5.71700000000001 49.664-17.152 10.923-11.435 16.384-27.136 16.384-47.104.0-21.8453-6.059-37.8027-18.176-47.872-11.947-10.24-27.904-15.36-47.872-15.36H38.248V157.304zM281.82 189.56C265.777 189.56 251.697 186.744 239.58 181.112 227.463 175.48 217.991 167.373 211.164 156.792 204.508 146.211 201.18 133.581 201.18 118.904S204.508 91.6827 211.164 81.272C217.82 70.6907 227.207 62.584 239.324 56.952c12.117-5.8027 26.283-8.704 42.496-8.704 16.213.0 30.379 2.816 42.496 8.448C336.433 62.328 345.82 70.4347 352.476 81.016 359.132 91.4267 362.46 104.056 362.46 118.904 362.46 133.411 359.132 145.955 352.476 156.536s-16.043 18.773-28.16 24.576C312.369 186.744 298.204 189.56 281.82 189.56zm0-28.16c13.824.0 24.661-3.84 32.512-11.52s11.776-18.005 11.776-30.976C326.108 105.763 322.183 95.4373 314.332 87.928 306.652 80.248 295.815 76.408 281.82 76.408c-13.824.0-24.661 3.84-32.512 11.52C241.628 95.608 237.788 105.933 237.788 118.904S241.628 142.2 249.308 149.88C257.159 157.56 267.996 161.4 281.82 161.4zM384.068 187V.375992H420.42V110.2l17.152-15.36L490.82 50.808h46.336l-64.768 53.504L539.46 187H494.148l-38.656-48.64L446.02 125.56l-25.6 20.736V187H384.068zm227.244 2.56c-22.699.0-40.107-4.096-52.224-12.288C546.971 169.08 540.485 157.987 539.632 143.992H575.216c1.024 15.36 13.397 23.04 37.12 23.04C622.747 167.032 630.939 165.667 636.912 162.936 642.885 160.035 645.872 155.512 645.872 149.368 645.872 144.76 644.763 141.347 642.544 139.128 640.325 136.739 636.571 134.947 631.28 133.752 625.989 132.557 618.651 131.533 609.264 130.68 593.733 129.144 581.189 127.011 571.632 124.28 562.075 121.379 555.077 117.283 550.64 111.992 546.373 106.701 544.24 99.6187 544.24 90.744 544.24 77.7733 550.128 67.448 561.904 59.768c11.947-7.68 28.501-11.52 49.664-11.52C631.195 48.248 646.811 52.0027 658.416 59.512 670.021 67.0213 676.421 77.688 677.616 91.512H643.056C642.373 84.344 639.131 79.0533 633.328 75.64 627.525 72.2267 620.187 70.52 611.312 70.52 601.925 70.52 594.245 71.9707 588.272 74.872 582.469 77.6027 579.568 81.9547 579.568 87.928 579.568 93.9013 582.469 97.912 588.272 99.96 594.075 102.008 603.547 103.715 616.688 105.08 632.389 106.445 645.019 108.579 654.576 111.48 664.133 114.211 671.045 118.392 675.312 124.024 679.579 129.485 681.712 137.165 681.712 147.064c0 12.8-5.803 23.125-17.408 30.976C652.869 185.72 635.205 189.56 611.312 189.56z" fill="#1d2d35"/></svg>
<svg class="doks-images-dark-mode svg-inline svg-inline-custom svg-darkmode" height="100%" width="70" viewBox="0 0 682 190" fill="none"><path d="M.616001 187V.375992H88.424c21.163.0 38.912 3.925338 53.248 11.776008 14.507 7.68 25.429 18.5173 32.768 32.512C181.949 58.6587 185.704 75.0427 185.704 93.816c0 19.968-4.011 36.864-12.032 50.688-7.851 13.824-19.029 24.405-33.536 31.744C125.629 183.416 108.392 187 88.424 187H.616001zM38.248 157.304H81.512c22.357.0 38.912-5.71700000000001 49.664-17.152 10.923-11.435 16.384-27.136 16.384-47.104.0-21.8453-6.059-37.8027-18.176-47.872-11.947-10.24-27.904-15.36-47.872-15.36H38.248V157.304zM281.82 189.56C265.777 189.56 251.697 186.744 239.58 181.112 227.463 175.48 217.991 167.373 211.164 156.792 204.508 146.211 201.18 133.581 201.18 118.904S204.508 91.6827 211.164 81.272C217.82 70.6907 227.207 62.584 239.324 56.952c12.117-5.8027 26.283-8.704 42.496-8.704 16.213.0 30.379 2.816 42.496 8.448C336.433 62.328 345.82 70.4347 352.476 81.016 359.132 91.4267 362.46 104.056 362.46 118.904 362.46 133.411 359.132 145.955 352.476 156.536s-16.043 18.773-28.16 24.576C312.369 186.744 298.204 189.56 281.82 189.56zm0-28.16c13.824.0 24.661-3.84 32.512-11.52s11.776-18.005 11.776-30.976C326.108 105.763 322.183 95.4373 314.332 87.928 306.652 80.248 295.815 76.408 281.82 76.408c-13.824.0-24.661 3.84-32.512 11.52C241.628 95.608 237.788 105.933 237.788 118.904S241.628 142.2 249.308 149.88C257.159 157.56 267.996 161.4 281.82 161.4zM384.068 187V.375992H420.42V110.2l17.152-15.36L490.82 50.808h46.336l-64.768 53.504L539.46 187H494.148l-38.656-48.64L446.02 125.56l-25.6 20.736V187H384.068zm227.244 2.56c-22.699.0-40.107-4.096-52.224-12.288C546.971 169.08 540.485 157.987 539.632 143.992H575.216c1.024 15.36 13.397 23.04 37.12 23.04C622.747 167.032 630.939 165.667 636.912 162.936 642.885 160.035 645.872 155.512 645.872 149.368 645.872 144.76 644.763 141.347 642.544 139.128 640.325 136.739 636.571 134.947 631.28 133.752 625.989 132.557 618.651 131.533 609.264 130.68 593.733 129.144 581.189 127.011 571.632 124.28 562.075 121.379 555.077 117.283 550.64 111.992 546.373 106.701 544.24 99.6187 544.24 90.744 544.24 77.7733 550.128 67.448 561.904 59.768c11.947-7.68 28.501-11.52 49.664-11.52C631.195 48.248 646.811 52.0027 658.416 59.512 670.021 67.0213 676.421 77.688 677.616 91.512H643.056C642.373 84.344 639.131 79.0533 633.328 75.64 627.525 72.2267 620.187 70.52 611.312 70.52 601.925 70.52 594.245 71.9707 588.272 74.872 582.469 77.6027 579.568 81.9547 579.568 87.928 579.568 93.9013 582.469 97.912 588.272 99.96 594.075 102.008 603.547 103.715 616.688 105.08 632.389 106.445 645.019 108.579 654.576 111.48 664.133 114.211 671.045 118.392 675.312 124.024 679.579 129.485 681.712 137.165 681.712 147.064c0 12.8-5.803 23.125-17.408 30.976C652.869 185.72 635.205 189.56 611.312 189.56z" fill="#fff"/></svg>
</a><button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website">
<svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
</button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Docs</h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><nav class="section-nav docs-links"><ul class=list-unstyled><li><details open><summary>Notes</summary><ul class="list-unstyled list-nested"><li><details open><summary>Programming</summary><ul class="list-unstyled list-nested"><li><a href=/docs/notes/programming/tmux/>tmux</a></li><li><a href=/docs/notes/programming/git-%E5%9F%BA%E7%A4%8E%E6%A6%82%E5%BF%B5%E8%88%87%E5%AF%A6%E6%88%B0%E6%8C%87%E4%BB%A4/>Git 基礎概念與實戰指令</a></li><li><a href=/docs/notes/programming/%E5%B8%B8%E7%94%A8linux%E6%8C%87%E4%BB%A4/>常用Linux指令</a></li><li><a href=/docs/notes/programming/docker/>常用Docker指令</a></li></ul></details></li><li><details open><summary>Others</summary><ul class="list-unstyled list-nested"><li><a href=/docs/notes/knowledge/webp-performance/>WebP圖片壓縮與解碼性能</a></li><li><a href=/docs/notes/knowledge/ffmpeg%E5%9F%BA%E7%A4%8E%E7%9F%A5%E8%AD%98/>FFmpeg基礎知識</a></li><li><a href=/docs/notes/knowledge/exiftool/>ExifTool</a></li></ul></details></li></ul></details></li><li><details open><summary>NAS</summary><ul class="list-unstyled list-nested"><li><a href=/docs/nas/truenas-smb-security/>TrueNas SMB 簽名及加密設定</a></li><li class=active><a aria-current=page href=/docs/nas/truenas-docker/>TrueNAS Docker</a></li><li><a href=/docs/nas/cloudflare-tunnel-ddns-guide/>Cloudflare Tunnel</a></li><li><details open><summary>Hugo Blowfish</summary><ul class="list-unstyled list-nested"><li><a href=/docs/nas/blowfish/settings/>基礎設定</a></li><li><a href=/docs/nas/blowfish/advance-custom/>進階客製化</a></li><li><a href=/docs/nas/blowfish/bug-fix/>問題修復</a></li></ul></details></li></ul></details></li></ul></nav></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel><span class=visually-hidden>ZSL Docs</span><svg class="doks-images-light-mode svg-inline svg-inline-custom svg-lightmode" height="100%" width="60" viewBox="0 0 682 190" fill="none"><path d="M.616001 187V.375992H88.424c21.163.0 38.912 3.925338 53.248 11.776008 14.507 7.68 25.429 18.5173 32.768 32.512C181.949 58.6587 185.704 75.0427 185.704 93.816c0 19.968-4.011 36.864-12.032 50.688-7.851 13.824-19.029 24.405-33.536 31.744C125.629 183.416 108.392 187 88.424 187H.616001zM38.248 157.304H81.512c22.357.0 38.912-5.71700000000001 49.664-17.152 10.923-11.435 16.384-27.136 16.384-47.104.0-21.8453-6.059-37.8027-18.176-47.872-11.947-10.24-27.904-15.36-47.872-15.36H38.248V157.304zM281.82 189.56C265.777 189.56 251.697 186.744 239.58 181.112 227.463 175.48 217.991 167.373 211.164 156.792 204.508 146.211 201.18 133.581 201.18 118.904S204.508 91.6827 211.164 81.272C217.82 70.6907 227.207 62.584 239.324 56.952c12.117-5.8027 26.283-8.704 42.496-8.704 16.213.0 30.379 2.816 42.496 8.448C336.433 62.328 345.82 70.4347 352.476 81.016 359.132 91.4267 362.46 104.056 362.46 118.904 362.46 133.411 359.132 145.955 352.476 156.536s-16.043 18.773-28.16 24.576C312.369 186.744 298.204 189.56 281.82 189.56zm0-28.16c13.824.0 24.661-3.84 32.512-11.52s11.776-18.005 11.776-30.976C326.108 105.763 322.183 95.4373 314.332 87.928 306.652 80.248 295.815 76.408 281.82 76.408c-13.824.0-24.661 3.84-32.512 11.52C241.628 95.608 237.788 105.933 237.788 118.904S241.628 142.2 249.308 149.88C257.159 157.56 267.996 161.4 281.82 161.4zM384.068 187V.375992H420.42V110.2l17.152-15.36L490.82 50.808h46.336l-64.768 53.504L539.46 187H494.148l-38.656-48.64L446.02 125.56l-25.6 20.736V187H384.068zm227.244 2.56c-22.699.0-40.107-4.096-52.224-12.288C546.971 169.08 540.485 157.987 539.632 143.992H575.216c1.024 15.36 13.397 23.04 37.12 23.04C622.747 167.032 630.939 165.667 636.912 162.936 642.885 160.035 645.872 155.512 645.872 149.368 645.872 144.76 644.763 141.347 642.544 139.128 640.325 136.739 636.571 134.947 631.28 133.752 625.989 132.557 618.651 131.533 609.264 130.68 593.733 129.144 581.189 127.011 571.632 124.28 562.075 121.379 555.077 117.283 550.64 111.992 546.373 106.701 544.24 99.6187 544.24 90.744 544.24 77.7733 550.128 67.448 561.904 59.768c11.947-7.68 28.501-11.52 49.664-11.52C631.195 48.248 646.811 52.0027 658.416 59.512 670.021 67.0213 676.421 77.688 677.616 91.512H643.056C642.373 84.344 639.131 79.0533 633.328 75.64 627.525 72.2267 620.187 70.52 611.312 70.52 601.925 70.52 594.245 71.9707 588.272 74.872 582.469 77.6027 579.568 81.9547 579.568 87.928 579.568 93.9013 582.469 97.912 588.272 99.96 594.075 102.008 603.547 103.715 616.688 105.08 632.389 106.445 645.019 108.579 654.576 111.48 664.133 114.211 671.045 118.392 675.312 124.024 679.579 129.485 681.712 137.165 681.712 147.064c0 12.8-5.803 23.125-17.408 30.976C652.869 185.72 635.205 189.56 611.312 189.56z" fill="#1d2d35"/></svg><svg class="doks-images-dark-mode svg-inline svg-inline-custom svg-darkmode" height="100%" width="60" viewBox="0 0 682 190" fill="none"><path d="M.616001 187V.375992H88.424c21.163.0 38.912 3.925338 53.248 11.776008 14.507 7.68 25.429 18.5173 32.768 32.512C181.949 58.6587 185.704 75.0427 185.704 93.816c0 19.968-4.011 36.864-12.032 50.688-7.851 13.824-19.029 24.405-33.536 31.744C125.629 183.416 108.392 187 88.424 187H.616001zM38.248 157.304H81.512c22.357.0 38.912-5.71700000000001 49.664-17.152 10.923-11.435 16.384-27.136 16.384-47.104.0-21.8453-6.059-37.8027-18.176-47.872-11.947-10.24-27.904-15.36-47.872-15.36H38.248V157.304zM281.82 189.56C265.777 189.56 251.697 186.744 239.58 181.112 227.463 175.48 217.991 167.373 211.164 156.792 204.508 146.211 201.18 133.581 201.18 118.904S204.508 91.6827 211.164 81.272C217.82 70.6907 227.207 62.584 239.324 56.952c12.117-5.8027 26.283-8.704 42.496-8.704 16.213.0 30.379 2.816 42.496 8.448C336.433 62.328 345.82 70.4347 352.476 81.016 359.132 91.4267 362.46 104.056 362.46 118.904 362.46 133.411 359.132 145.955 352.476 156.536s-16.043 18.773-28.16 24.576C312.369 186.744 298.204 189.56 281.82 189.56zm0-28.16c13.824.0 24.661-3.84 32.512-11.52s11.776-18.005 11.776-30.976C326.108 105.763 322.183 95.4373 314.332 87.928 306.652 80.248 295.815 76.408 281.82 76.408c-13.824.0-24.661 3.84-32.512 11.52C241.628 95.608 237.788 105.933 237.788 118.904S241.628 142.2 249.308 149.88C257.159 157.56 267.996 161.4 281.82 161.4zM384.068 187V.375992H420.42V110.2l17.152-15.36L490.82 50.808h46.336l-64.768 53.504L539.46 187H494.148l-38.656-48.64L446.02 125.56l-25.6 20.736V187H384.068zm227.244 2.56c-22.699.0-40.107-4.096-52.224-12.288C546.971 169.08 540.485 157.987 539.632 143.992H575.216c1.024 15.36 13.397 23.04 37.12 23.04C622.747 167.032 630.939 165.667 636.912 162.936 642.885 160.035 645.872 155.512 645.872 149.368 645.872 144.76 644.763 141.347 642.544 139.128 640.325 136.739 636.571 134.947 631.28 133.752 625.989 132.557 618.651 131.533 609.264 130.68 593.733 129.144 581.189 127.011 571.632 124.28 562.075 121.379 555.077 117.283 550.64 111.992 546.373 106.701 544.24 99.6187 544.24 90.744 544.24 77.7733 550.128 67.448 561.904 59.768c11.947-7.68 28.501-11.52 49.664-11.52C631.195 48.248 646.811 52.0027 658.416 59.512 670.021 67.0213 676.421 77.688 677.616 91.512H643.056C642.373 84.344 639.131 79.0533 633.328 75.64 627.525 72.2267 620.187 70.52 611.312 70.52 601.925 70.52 594.245 71.9707 588.272 74.872 582.469 77.6027 579.568 81.9547 579.568 87.928 579.568 93.9013 582.469 97.912 588.272 99.96 594.075 102.008 603.547 103.715 616.688 105.08 632.389 106.445 645.019 108.579 654.576 111.48 664.133 114.211 671.045 118.392 675.312 124.024 679.579 129.485 681.712 137.165 681.712 147.064c0 12.8-5.803 23.125-17.408 30.976C652.869 185.72 635.205 189.56 611.312 189.56z" fill="#fff"/></svg></h5><button type=button class="btn btn-link nav-link p-0 ms-auto" data-bs-dismiss=offcanvas aria-label=Close><svg class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class="nav-link active" href=https://a4.zsl0621.cc/docs/intro/ aria-current=true>Docs</a></li><li class=nav-item><a target=blank class=nav-link href=https://www.zsl0621.cc/>Blog<svg class="ms-1 mb-1 icon icon-tabler icon-tabler-external-link" width="20" height="20" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 6H6A2 2 0 004 8v10a2 2 0 002 2h10a2 2 0 002-2v-6"/><path d="M11 13l9-9"/><path d="M15 4h5v5"/></svg></a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website">
<svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
</button>
<button id=buttonColorMode class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type=button aria-label="Toggle theme"><svg data-bs-theme-value="dark" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/></svg><svg data-bs-theme-value="light" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class="nav-item d-none d-lg-flex py-1 col-auto"><div class="vr h-100 mx-2 text-muted"></div></li><li class=nav-item><a rel=me class="nav-link social-link" href="https://github.com/ZhenShuo2021?tab=repositories"><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li><li class=nav-item><a rel=me class="nav-link social-link" href=https://twitter.com/getdoks><svg class="icon icon-tabler icon-tabler-brand-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 4l11.733 16H20L8.267 4z"/><path d="M4 20l6.768-6.768m2.46-2.46L20 4"/></svg><small class="ms-2 visually-hidden">Twitter</small></a></li></ul></div></div></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=UTF-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class="submitted d-none"><time class=created-date>Date here</time></div></header><div class=content>Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-fluid" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class="section-nav docs-links"><ul class=list-unstyled><li><details open><summary>Notes</summary><ul class="list-unstyled list-nested"><li><details open><summary>Programming</summary><ul class="list-unstyled list-nested"><li><a href=/docs/notes/programming/tmux/>tmux</a></li><li><a href=/docs/notes/programming/git-%E5%9F%BA%E7%A4%8E%E6%A6%82%E5%BF%B5%E8%88%87%E5%AF%A6%E6%88%B0%E6%8C%87%E4%BB%A4/>Git 基礎概念與實戰指令</a></li><li><a href=/docs/notes/programming/%E5%B8%B8%E7%94%A8linux%E6%8C%87%E4%BB%A4/>常用Linux指令</a></li><li><a href=/docs/notes/programming/docker/>常用Docker指令</a></li></ul></details></li><li><details open><summary>Others</summary><ul class="list-unstyled list-nested"><li><a href=/docs/notes/knowledge/webp-performance/>WebP圖片壓縮與解碼性能</a></li><li><a href=/docs/notes/knowledge/ffmpeg%E5%9F%BA%E7%A4%8E%E7%9F%A5%E8%AD%98/>FFmpeg基礎知識</a></li><li><a href=/docs/notes/knowledge/exiftool/>ExifTool</a></li></ul></details></li></ul></details></li><li><details open><summary>NAS</summary><ul class="list-unstyled list-nested"><li><a href=/docs/nas/truenas-smb-security/>TrueNas SMB 簽名及加密設定</a></li><li class=active><a aria-current=page href=/docs/nas/truenas-docker/>TrueNAS Docker</a></li><li><a href=/docs/nas/cloudflare-tunnel-ddns-guide/>Cloudflare Tunnel</a></li><li><details open><summary>Hugo Blowfish</summary><ul class="list-unstyled list-nested"><li><a href=/docs/nas/blowfish/settings/>基礎設定</a></li><li><a href=/docs/nas/blowfish/advance-custom/>進階客製化</a></li><li><a href=/docs/nas/blowfish/bug-fix/>問題修復</a></li></ul></details></li></ul></details></li></ul></nav></div><div class="col container-fw d-lg-flex flex-lg-row justify-content-center mx-auto"><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>On this page</h3><nav id=toc><ul><li><a href=#前言>前言</a></li><li><a href=#immich>Immich</a></li><li><a href=#photoprism>PhotoPrism</a></li><li><a href=#librephoto>LibrePhoto</a></li><li><a href=#plex>Plex</a></li><li><a href=#stash>Stash</a></li><li><a href=#lanraragi>Lanraragi</a></li><li><a href=#stirling-pdf>Stirling PDF</a></li></ul></nav></div><div class=feedback-links><h3>Contribute</h3><ul class=list-unstyled><li><a href=https://github.com/ZhenShuo2021/getdoks/issues>Bug Report</a></li></ul></div></nav><main class="docs-content col-lg-16 col-xl-12"><h1>TrueNAS Docker</h1><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><a href=#前言>前言</a></li><li><a href=#immich>Immich</a></li><li><a href=#photoprism>PhotoPrism</a></li><li><a href=#librephoto>LibrePhoto</a></li><li><a href=#plex>Plex</a></li><li><a href=#stash>Stash</a></li><li><a href=#lanraragi>Lanraragi</a></li><li><a href=#stirling-pdf>Stirling PDF</a></li></ul></nav></div></details></nav><h2 id=前言>前言<a href=#前言 class=anchor aria-hidden=true>#</a></h2><p>弄完基礎的檔案分享設定之後就是玩 docker，本文列出幾個常見的 docker-compose.yml 以便一鍵部屬。</p><p>還有個好消息，TrueNAS 在 2024/10 月版本將要放棄 k3s 改用 docker，這裡先放上幾個 docker-compose.yml，對相簿選擇障礙的可以看<a href=https://github.com/meichthys/foss_photo_libraries>這裡</a>。</p><h2 id=immich>Immich<a href=#immich class=anchor aria-hidden=true>#</a></h2><p>版本：v1.108.0<br>這是最推薦的自架相簿，有些人可能會擔心他會破壞資料夾結構，尤其是攝影師，不過使用<a href=https://immich.app/docs/guides/external-library/>外部庫</a>掛載就沒有這個問題。<br>由於現在還在非常積極發展的階段，建議掛載後加上<code>:ro</code>唯獨以免誤刪。</p><p>docker-compose.yml: 改掛載路徑就可用<div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>immich</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>immich-server</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>immich_server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>ghcr.io/immich-app/immich-server:${IMMICH_VERSION:-release}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>${UPLOAD_LOCATION}:/usr/src/app/upload</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/photo/immich:/usr/src/app/external:ro</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/etc/localtime:/etc/localtime:ro</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>env_file</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>.env</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>2283</span><span class=p>:</span><span class=m>3001</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>database</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>immich-machine-learning</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>immich_machine_learning</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># For hardware acceleration, add one of -[armnn, cuda, openvino] to the image tag.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># Example tag: ${IMMICH_VERSION:-release}-cuda</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>ghcr.io/immich-app/immich-machine-learning:${IMMICH_VERSION:-release}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># extends: # uncomment this section for hardware acceleration - see https://immich.app/docs/features/ml-hardware-acceleration</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#   file: hwaccel.ml.yml</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#   service: cpu # set to one of [armnn, cuda, openvino, openvino-wsl] for accelerated inference - use the `-wsl` version for WSL2 where applicable</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>model-cache:/cache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>env_file</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>.env</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>redis</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>immich_redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>docker.io/redis:6.2-alpine@sha256:328fe6a5822256d065debb36617a8169dbfbd77b797c525288e465f56c1d392b</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>healthcheck</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>test</span><span class=p>:</span><span class=w> </span><span class=l>redis-cli ping || exit 1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>database</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>immich_postgres</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>docker.io/tensorchord/pgvecto-rs:pg14-v0.2.0@sha256:90724186f0a3517cf6914295b5ab410db9ce23190a2d9d0b9dd6463e3fa298f0</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>POSTGRES_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=l>${DB_PASSWORD}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>POSTGRES_USER</span><span class=p>:</span><span class=w> </span><span class=l>${DB_USERNAME}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>POSTGRES_DB</span><span class=p>:</span><span class=w> </span><span class=l>${DB_DATABASE_NAME}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>POSTGRES_INITDB_ARGS</span><span class=p>:</span><span class=w> </span><span class=s1>&#39;--data-checksums&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>${DB_DATA_LOCATION}:/var/lib/postgresql/data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>healthcheck</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>test</span><span class=p>:</span><span class=w> </span><span class=l>pg_isready --dbname=&#39;${DB_DATABASE_NAME}&#39; --username=&#39;${DB_USERNAME}&#39; || exit 1; Chksum=&#34;$$(psql --dbname=&#39;${DB_DATABASE_NAME}&#39; --username=&#39;${DB_USERNAME}&#39; --tuples-only --no-align --command=&#39;SELECT COALESCE(SUM(checksum_failures), 0) FROM pg_stat_database&#39;)&#34;; echo &#34;checksum failure count is $$Chksum&#34;; [ &#34;$$Chksum&#34; = &#39;0&#39; ] || exit 1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>interval</span><span class=p>:</span><span class=w> </span><span class=l>5m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>start_interval</span><span class=p>:</span><span class=w> </span><span class=l>30s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>start_period</span><span class=p>:</span><span class=w> </span><span class=l>5m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;postgres&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;-c&#34;</span><span class=w> </span><span class=p>,</span><span class=s2>&#34;shared_preload_libraries=vectors.so&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;-c&#34;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;search_path=&#34;$$user&#34;, public, vectors&#39;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;-c&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;logging_collector=on&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;-c&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;max_wal_size=2GB&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;-c&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;shared_buffers=512MB&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;-c&#34;</span><span class=p>,</span><span class=w> </span><span class=s2>&#34;wal_compression=on&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=l>model-cache:</span></span></span></code></pre></div></figure></div>.env: 改掛載路徑就可用<div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># You can find documentation for all the supported env variables at https://immich.app/docs/install/environment-variables</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># The location where your uploaded files are stored</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>UPLOAD_LOCATION=/home/user/photo/immich/upload</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># The location where your database files are stored</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>DB_DATA_LOCATION=./postgres</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># The Immich version to use. You can pin this to a specific version like &#34;v1.71.0&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>IMMICH_VERSION=release</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Connection secret for postgres. You should change it to a random password</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>DB_PASSWORD=postgres</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># The values below this line do not need to be changed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>###################################################################################</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>DB_USERNAME=postgres</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>DB_DATABASE_NAME=immich</span></span></span></code></pre></div></figure></div></p><h2 id=photoprism>PhotoPrism<a href=#photoprism class=anchor aria-hidden=true>#</a></h2><p>版本：240531-60b3a4628<br>比起相簿他更像是畫廊，有各種圖片檢視方式，而 immich 是以時間軸為核心的瀏覽方式。最大的差別是免費版沒有帳號控制，一個 PhotoPrism 實例就是一個帳號。</p><p>docker-compose.yml: 改掛載路徑/帳號密碼就可用，那堆環境設定基本上用不到。<br><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>photoprism</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## Use photoprism/photoprism:preview for testing preview builds:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>photoprism/photoprism:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## Don&#39;t enable automatic restarts until PhotoPrism has been properly configured and tested!</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## If the service gets stuck in a restart loop, this points to a memory, filesystem, network, or database issue:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## https://docs.photoprism.app/getting-started/troubleshooting/#fatal-server-errors</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>stop_grace_period</span><span class=p>:</span><span class=w> </span><span class=l>10s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>mariadb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>security_opt</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>seccomp:unconfined</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>apparmor:unconfined</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## Server port mapping in the format &#34;Host:Container&#34;. To use a different port, change the host port on</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## the left-hand side and keep the container port, e.g. &#34;80:2342&#34; (for HTTP) or &#34;443:2342 (for HTTPS):</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;2342:2342&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## Before you start the service, please check the following config options (and change them as needed):</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## https://docs.photoprism.app/getting-started/config-options/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_ADMIN_USER</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;admin&#34;</span><span class=w>                 </span><span class=c># admin login username</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_ADMIN_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;password&#34;</span><span class=w>          </span><span class=c># initial admin password (8-72 characters)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_AUTH_MODE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;password&#34;</span><span class=w>               </span><span class=c># authentication mode (public, password)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_SITE_URL</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;http://localhost:2342/&#34;</span><span class=w>  </span><span class=c># server URL in the format &#34;http(s)://domain.name(:port)/(path)&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DISABLE_TLS</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>                </span><span class=c># disables HTTPS/TLS even if the site URL starts with https:// and a certificate is available</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DEFAULT_TLS</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>                 </span><span class=c># defaults to a self-signed HTTPS/TLS certificate if no other certificate is available</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_ORIGINALS_LIMIT</span><span class=p>:</span><span class=w> </span><span class=m>5000</span><span class=w>               </span><span class=c># file size limit for originals in MB (increase for high-res video)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_HTTP_COMPRESSION</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;gzip&#34;</span><span class=w>            </span><span class=c># improves transfer speed and bandwidth utilization (none or gzip)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_LOG_LEVEL</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;info&#34;</span><span class=w>                   </span><span class=c># log level: trace, debug, info, warning, error, fatal, or panic</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_READONLY</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>                   </span><span class=c># do not modify originals directory (reduced functionality)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_EXPERIMENTAL</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>               </span><span class=c># enables experimental features</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DISABLE_CHOWN</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>              </span><span class=c># disables updating storage permissions via chmod and chown on startup</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DISABLE_WEBDAV</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>             </span><span class=c># disables built-in WebDAV server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DISABLE_SETTINGS</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>           </span><span class=c># disables settings UI and API</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DISABLE_TENSORFLOW</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>         </span><span class=c># disables all features depending on TensorFlow</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DISABLE_FACES</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>              </span><span class=c># disables face detection and recognition (requires TensorFlow)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DISABLE_CLASSIFICATION</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>     </span><span class=c># disables image classification (requires TensorFlow)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DISABLE_VECTORS</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>            </span><span class=c># disables vector graphics support</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DISABLE_RAW</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>                </span><span class=c># disables indexing and conversion of RAW images</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_RAW_PRESETS</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>                </span><span class=c># enables applying user presets when converting RAW images (reduces performance)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_SIDECAR_YAML</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>                </span><span class=c># creates YAML sidecar files to back up picture metadata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_BACKUP_ALBUMS</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>               </span><span class=c># creates YAML files to back up album metadata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_BACKUP_DATABASE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>             </span><span class=c># creates regular backups based on the configured schedule</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_BACKUP_SCHEDULE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;daily&#34;</span><span class=w>            </span><span class=c># backup SCHEDULE in cron format (e.g. &#34;0 12 * * *&#34; for daily at noon) or at a random time (daily, weekly)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_INDEX_SCHEDULE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>                  </span><span class=c># indexing SCHEDULE in cron format (e.g. &#34;@every 3h&#34; for every 3 hours; &#34;&#34; to disable)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_AUTO_INDEX</span><span class=p>:</span><span class=w> </span><span class=m>300</span><span class=w>                     </span><span class=c># delay before automatically indexing files in SECONDS when uploading via WebDAV (-1 to disable)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_AUTO_IMPORT</span><span class=p>:</span><span class=w> </span>-<span class=m>1</span><span class=w>                     </span><span class=c># delay before automatically importing files in SECONDS when uploading via WebDAV (-1 to disable)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DETECT_NSFW</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;false&#34;</span><span class=w>                </span><span class=c># automatically flags photos as private that MAY be offensive (requires TensorFlow)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_UPLOAD_NSFW</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>                 </span><span class=c># allows uploads that MAY be offensive (no effect without TensorFlow)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DATABASE_DRIVER</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;sqlite&#34;</span><span class=w>         </span><span class=c># SQLite is an embedded database that does not require a separate database server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DATABASE_DRIVER</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;mysql&#34;</span><span class=w>            </span><span class=c># MariaDB 10.5.12+ (MySQL successor) offers significantly better performance compared to SQLite</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DATABASE_SERVER</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;mariadb:3306&#34;</span><span class=w>     </span><span class=c># MariaDB database server (hostname:port)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DATABASE_NAME</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;photoprism&#34;</span><span class=w>         </span><span class=c># MariaDB database schema name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DATABASE_USER</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;photoprism&#34;</span><span class=w>         </span><span class=c># MariaDB database user name</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_DATABASE_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;insecure&#34;</span><span class=w>       </span><span class=c># MariaDB database user password</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_SITE_CAPTION</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;這裡是你網頁標題名稱&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_SITE_DESCRIPTION</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>                </span><span class=c># meta site description</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>PHOTOPRISM_SITE_AUTHOR</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;&#34;</span><span class=w>                     </span><span class=c># meta site author</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## Video Transcoding (https://docs.photoprism.app/getting-started/advanced/transcoding/):</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># PHOTOPRISM_FFMPEG_ENCODER: &#34;software&#34;        # H.264/AVC encoder (software, intel, nvidia, apple, raspberry, or vaapi)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># PHOTOPRISM_FFMPEG_SIZE: &#34;1920&#34;               # video size limit in pixels (720-7680) (default: 3840)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># PHOTOPRISM_FFMPEG_BITRATE: &#34;32&#34;              # video bitrate limit in Mbit/s (default: 50)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## Run/install on first startup (options: update https gpu ffmpeg tensorflow davfs clitools clean):</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># PHOTOPRISM_INIT: &#34;https gpu tensorflow&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## Run as a non-root user after initialization (supported: 0, 33, 50-99, 500-600, and 900-1200):</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># PHOTOPRISM_UID: 1000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># PHOTOPRISM_GID: 1000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># PHOTOPRISM_UMASK: 0000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## Start as non-root user before initialization (supported: 0, 33, 50-99, 500-600, and 900-1200):</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># user: &#34;1000:1000&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## Share hardware devices with FFmpeg and TensorFlow (optional):</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># devices:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#  - &#34;/dev/dri:/dev/dri&#34;                         # Intel QSV</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#  - &#34;/dev/nvidia0:/dev/nvidia0&#34;                 # Nvidia CUDA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#  - &#34;/dev/nvidiactl:/dev/nvidiactl&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#  - &#34;/dev/nvidia-modeset:/dev/nvidia-modeset&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#  - &#34;/dev/nvidia-nvswitchctl:/dev/nvidia-nvswitchctl&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#  - &#34;/dev/nvidia-uvm:/dev/nvidia-uvm&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#  - &#34;/dev/nvidia-uvm-tools:/dev/nvidia-uvm-tools&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>#  - &#34;/dev/video11:/dev/video11&#34;                 # Video4Linux Video Encode Device (h264_v4l2m2m)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>working_dir</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;/photoprism&#34;</span><span class=w> </span><span class=c># do not change or remove</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## Storage Folders: &#34;~&#34; is a shortcut for your home directory, &#34;.&#34; for the current directory</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># &#34;/host/folder:/photoprism/folder&#34;                # Example</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;/home/user/photo/photoprism/A:/photoprism/originals/A&#34;</span><span class=w>  </span><span class=c># Original media files (DO NOT REMOVE)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;/home/user/photo/photoprism/B:/photoprism/originals/B&#34;</span><span class=w>  </span><span class=c># 分別掛載三個（白名單）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;/home/user/photo/photoprism/C:/photoprism/originals/C&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># - &#34;/example/family:/photoprism/originals/family&#34; # *Additional* media folders can be mounted like this</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c># - &#34;~/Import:/photoprism/import&#34;                  # *Optional* base folder from which files can be imported to originals</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;./storage:/photoprism/storage&#34;</span><span class=w>                  </span><span class=c># *Writable* storage folder for cache, database, and sidecar files (DO NOT REMOVE)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## MariaDB Database Server (recommended)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## see https://docs.photoprism.app/getting-started/faq/#should-i-use-sqlite-mariadb-or-mysql</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>mariadb</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>mariadb:11</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## If MariaDB gets stuck in a restart loop, this points to a memory or filesystem issue:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## https://docs.photoprism.app/getting-started/troubleshooting/#fatal-server-errors</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>stop_grace_period</span><span class=p>:</span><span class=w> </span><span class=l>5s</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>security_opt</span><span class=p>:</span><span class=w> </span><span class=c># see https://github.com/MariaDB/mariadb-docker/issues/434#issuecomment-1136151239</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>seccomp:unconfined</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>apparmor:unconfined</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span>--<span class=l>innodb-buffer-pool-size=512M --transaction-isolation=READ-COMMITTED --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci --max-connections=512 --innodb-rollback-on-timeout=OFF --innodb-lock-wait-timeout=120</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## Never store database files on an unreliable device such as a USB flash drive, an SD card, or a shared network folder:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;./database:/var/lib/mysql&#34;</span><span class=w> </span><span class=c># DO NOT REMOVE</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MARIADB_AUTO_UPGRADE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MARIADB_INITDB_SKIP_TZINFO</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;1&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MARIADB_DATABASE</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;photoprism&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MARIADB_USER</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;photoprism&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MARIADB_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;insecure&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>MARIADB_ROOT_PASSWORD</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;insecure&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## Watchtower upgrades services automatically (optional)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## see https://docs.photoprism.app/getting-started/updates/#watchtower</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c>## activate via &#34;COMPOSE_PROFILES=update docker compose up -d&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>watchtower</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>containrrr/watchtower</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>profiles</span><span class=p>:</span><span class=w> </span><span class=p>[</span><span class=s2>&#34;update&#34;</span><span class=p>]</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>WATCHTOWER_CLEANUP</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;true&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>WATCHTOWER_POLL_INTERVAL</span><span class=p>:</span><span class=w> </span><span class=m>7200</span><span class=w> </span><span class=c># checks for updates every two hours</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;/var/run/docker.sock:/var/run/docker.sock&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;~/.docker/config.json:/config.json&#34;</span><span class=w> </span><span class=c># optional, for authentication if you have a Docker Hub account</span></span></span></code></pre></div></figure></div></p><h2 id=librephoto>LibrePhoto<a href=#librephoto class=anchor aria-hidden=true>#</a></h2><p>版本：不重要（2024/07）<br>如果你很喜歡他的 UI 就用吧，問題有點多，對我來說最有用的功能是圖片排序選項有隨機。</p><p>.env: 改掛載路徑/帳號密碼就可用，docker-compose「不能動」<div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># pw</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>userName=admin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>userPass=admin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># This file contains all the things you need to change to set up your Libre Photos. </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># There are a few items that must be set for it to work such as the location of your photos.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># After the mandatory entries there are some optional ones that you may set. </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Start of mandatory changes. </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Location of your photos.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>scanDirectory=/home/user/photo</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Internal data of LibrePhotos</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>data=./librephotos/data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ------------------------------------------------------------------------------------------------</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Wow, we are at the optional now. Pretty easy so far. You do not have to change any of the below.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Set this value if you have a custom domain name. This allows uploads and django-admin access. If you do not have a custom domain name, leave this blank.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>csrfTrustedOrigins=</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#What port should Libre Photos be accessed at (Default 3000)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>httpPort=2497</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># What branch should we install the latest weekly build or the development branch (dev)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>tag=latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Number of workers, which take care of the request to the api. This setting can dramatically affect the ram usage.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># A positive integer generally in the 2-4 x $(NUM_CORES) range.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># You’ll want to vary this a bit to find the best for your particular workload.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Each worker needs 800MB of RAM. Change at your own will. Default is 2.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>gunniWorkers=4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># You can set the database name. Did you know Libre Photos was forked from OwnPhotos?</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>dbName=librephotos</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Here you can change the user name for the database.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>dbUser=docker</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># The password used by the database.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>dbPass=AaAa1234</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Default minimum rating to interpret as favorited. This default value is used when creating a new user.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Users can change this in their settings (Dashboards &gt; Library).</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>DEFAULT_FAVORITE_MIN_RATING=4</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Database host. Only change this if you want to use your own existing Postgres server. If using your own server, you can remove the &#39;db&#39; container from docker-compose.yml. If you&#39;re changing the name of the DB&#39;s container name (DB_CONT_NAME further down), you need to set this variable to match that name too.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>dbHost=db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Set the names of the docker containers to your own entries. Or don&#39;t, I&#39;m not your dad.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Changing these will require you to `make rename` to rename the services, and start the system with your chosen `docker-compose up -d` invocation again.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Note that changing the DB_CONT_NAME will also need you to set the `dbHost` variable to the same value.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>DB_CONT_NAME=db</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>BACKEND_CONT_NAME=backend</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>FRONTEND_CONT_NAME=frontend</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>PROXY_CONT_NAME=proxy</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>PGADMIN_CONT_NAME=pgadmin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># ---------------------------------------------------------------------------------------------</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># If you are not a developer ignore the following parameters: you will never need them.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Where shall we store the backend and frontend code files.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>codedir=./librephotos/code</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># Location for pgAdmin</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=l>pgAdminLocation=./librephotos/pgadmin</span></span></span></code></pre></div></figure></div></p><h2 id=plex>Plex<a href=#plex class=anchor aria-hidden=true>#</a></h2><p>版本：1.40.4.8679-424562606<br>這個是網路上抄來的，不曉得為何很難找（跑得動的）。進去之後記得要把不安全網路打勾，因為一般來說內網連線沒有 https，不打勾連伺服器 (NAS) 都看不到</p><p>docker-compose.yml: 改掛載路徑/PLEX_CLAIM/ADVERTISE_IP就可用<br><div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w> </span><span class=nt>plex</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>plexinc/pms-docker:latest                 </span><span class=w> </span><span class=c># latest 安裝最新的版本</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>hostname</span><span class=p>:</span><span class=w> </span><span class=l>PlexServer                             </span><span class=w> </span><span class=c># 自定義主機名稱</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always                                  </span><span class=w> </span><span class=c># 設置重啟策略</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=s2>&#34;./config:/config&#34;</span><span class=w>          </span><span class=c># Plex 配置文件目錄</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span><span class=c>#- &#34;&#39;數據目錄&#39;/plex/transcode:/transcode&#34;    # Plex 轉碼文件目錄</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=s2>&#34;./data:/data&#34;</span><span class=w>              </span><span class=c># Plex 數據文件目錄</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=s2>&#34;/home/user/vider:/video&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=m>32400</span><span class=p>:</span><span class=m>32400</span><span class=l>/tcp                              </span><span class=w> </span><span class=c># Plex 網頁訪問端口，例如要改為通過 8080 端口訪問，就修改為8080:32400</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=m>3005</span><span class=p>:</span><span class=m>3005</span><span class=l>/tcp                                </span><span class=w> </span><span class=c># Plex Companion</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=m>8324</span><span class=p>:</span><span class=m>8324</span><span class=l>/tcp                                </span><span class=w> </span><span class=c># controlling Plex for Roku via Plex Companion</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=m>32469</span><span class=p>:</span><span class=m>32469</span><span class=l>/tcp                              </span><span class=w> </span><span class=c># access to the Plex DLNA Server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=m>32468</span><span class=p>:</span><span class=m>1900</span><span class=l>/udp                               </span><span class=w> </span><span class=c># access to the Plex DLNA Server</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=m>32410</span><span class=p>:</span><span class=m>32410</span><span class=l>/udp                              </span><span class=w> </span><span class=c># current GDM network discovery</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=m>32412</span><span class=p>:</span><span class=m>32412</span><span class=l>/udp                              </span><span class=w> </span><span class=c># current GDM network discovery</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=m>32413</span><span class=p>:</span><span class=m>32413</span><span class=l>/udp                              </span><span class=w> </span><span class=c># current GDM network discovery</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span>- <span class=m>32414</span><span class=p>:</span><span class=m>32414</span><span class=l>/udp                              </span><span class=w> </span><span class=c># current GDM network discovery</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=c># devices:                                        # Share hardware devices with FFmpeg (optional)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=c>#  - &#34;/dev/dri:/dev/dri&#34;                        # Intel QSV</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=c>#  - &#34;/dev/nvidia0:/dev/nvidia0&#34;                # Nvidia CUDA</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=c>#  - &#34;/dev/nvidiactl:/dev/nvidiactl&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=c>#  - &#34;/dev/nvidia-modeset:/dev/nvidia-modeset&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=c>#  - &#34;/dev/nvidia-nvswitchctl:/dev/nvidia-nvswitchctl&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=c>#  - &#34;/dev/nvidia-uvm:/dev/nvidia-uvm&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=c>#  - &#34;/dev/nvidia-uvm-tools:/dev/nvidia-uvm-tools&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=c>#  - &#34;/dev/video11:/dev/video11&#34;                # Raspberry V4L2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>   </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>TZ</span><span class=p>:</span><span class=w> </span><span class=l>Asia/Taipei                              </span><span class=w> </span><span class=c># 容器內部時區</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>PLEX_UID</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>                                     </span><span class=c># 在容器內創建的用戶 ID（不懂勿改）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>PLEX_GID</span><span class=p>:</span><span class=w> </span><span class=m>0</span><span class=w>                                     </span><span class=c># 在容器內創建的用戶組 ID（不懂勿改）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>PLEX_CLAIM</span><span class=p>:</span><span class=w> </span><span class=l>claim-hz2o-_1B6VxsQo8xzBfi  </span><span class=w> </span><span class=c># 真實伺服器的聲明令牌，您可以通過訪問 https://www.plex.tv/claim 獲取聲明令牌以將您的伺服器登錄到您的 Plex 帳戶</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>     </span><span class=nt>ADVERTISE_IP</span><span class=p>:</span><span class=w> </span><span class=m>192.168.50.97</span><span class=p>:</span><span class=m>32400</span><span class=l>/             </span><span class=w> </span><span class=c># 填寫外部訪問的固定 IP 或域名，沒有的話可以刪除此行</span></span></span></code></pre></div></figure></div></p><h2 id=stash>Stash<a href=#stash class=anchor aria-hidden=true>#</a></h2><p>版本：0.26.2</p><p>docker-compose.yml: 改/data路徑就可用，其他元資料改不改都可以<div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># APPNICENAME=Stash</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c># APPDESCRIPTION=An organizer for your porn, written in Go</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stash</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>stashapp/stash:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>stash</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>unless-stopped</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## the container&#39;s port must be the same with the STASH_PORT in the environment section</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=s2>&#34;9999:9999&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c>## If you intend to use stash&#39;s DLNA functionality uncomment the below network mode and comment out the above ports section</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=c># network_mode: host</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>logging</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>driver</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;json-file&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>options</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>max-file</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;10&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>max-size</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;2m&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>STASH_STASH=/data/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>STASH_GENERATED=/generated/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>STASH_METADATA=/metadata/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>STASH_CACHE=/cache/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## Adjust below to change default port (9999)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>STASH_PORT=9999</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/etc/localtime:/etc/localtime:ro</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## Adjust below paths (the left part) to your liking.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## E.g. you can change ./config:/root/.stash to ./stash:/root/.stash</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## Keep configs, scrapers, and plugins here.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/stash-app/config:/root/.stash</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## Point this at your collection.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/video:/data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## This is where your stash&#39;s metadata lives</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/stash-app/metadata:/metadata</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## Any other cache content.</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/stash-app/cache:/cache</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## Where to store binary blob data (scene covers, images)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/stash-app/blobs:/blobs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=c>## Where to store generated content (screenshots,previews,transcodes,sprites)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/stash-app/generated:/generated</span></span></span></code></pre></div></figure></div></p><h2 id=lanraragi>Lanraragi<a href=#lanraragi class=anchor aria-hidden=true>#</a></h2><p>版本：0.9.10</p><p>docker-compose.yml: 改掛載路徑就可用，注意修改密碼要重啟才會生效<div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>lanraragi</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>difegue/lanraragi:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>lanraragi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/photo/lanraragi:/home/koyomi/lanraragi/content</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/docker/lanraragi/database:/home/koyomi/lanraragi/database</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/docker/lanraragi/thumb:/home/koyomi/lanraragi/thumb</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/etc/localtime:/etc/localtime:ro</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=m>2279</span><span class=p>:</span><span class=m>3000</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span></span></span></code></pre></div></figure></div></p><h2 id=stirling-pdf>Stirling PDF<a href=#stirling-pdf class=anchor aria-hidden=true>#</a></h2><p>版本：0.26.0</p><p>docker-compose.yml: 改掛載路徑就可用<div class=expressive-code><figure class="frame not-content"><figcaption class=header><span class=title></span></figcaption><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>services</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>stirling-pdf</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>frooodle/s-pdf:latest</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>container_name</span><span class=p>:</span><span class=w> </span><span class=l>stirling-pdf</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>       </span>- <span class=s1>&#39;8080:8080&#39;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/user/docker/stirlingpdf/tessdata:/usr/share/tessdata</span><span class=w> </span><span class=c>#Required for extra OCR languages</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>/home/uesr/docker/stirlingpdf/configs:/configs</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=c>#      - ./customFiles:/customFiles/ - ./logs:/logs/</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>environment</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>DOCKER_ENABLE_SECURITY=false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=l>INSTALL_BOOK_AND_ADVANCED_HTML_OPS=false</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>restart</span><span class=p>:</span><span class=w> </span><span class=l>always</span></span></span></code></pre></div></figure></div></p><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=edit-page><a href=https://github.com/gethyas/getdoks.org/blob/main/content//docs/nas/truenas-docker.md><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>
Edit this page on GitHub</a></div></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M5 12l6 6"/><path d="M5 12l6-6"/></svg></div><div class="d-flex flex-column"><div class=text-body-secondary>Prev</div><a href=/docs/nas/truenas-smb-security/ class="stretched-link text-reset text-decoration-none">TrueNas SMB 簽名及加密設定</a></div></div></div><div class=m-2></div><div class="card text-end w-100"><div class="card-body d-flex justify-content-end"><div class="d-flex flex-column"><div class=text-body-secondary>Next</div><a href=/docs/nas/cloudflare-tunnel-ddns-guide/ class="stretched-link text-reset text-decoration-none">Cloudflare Tunnel</a></div><div class="d-flex flex-column justify-content-center"><svg class="icon icon-tabler icon-tabler-arrow-right" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M13 18l6-6"/><path d="M13 6l6 6"/></svg></div></div></div></div></main></div></div><span id=docsearch-lvl0 hidden>NAS</span></div></div><footer class="footer text-muted"><div class=container-fluid><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=https://gethyas.com/privacy/>Privacy Policy</a></li><li class=list-inline-item><a class=text-muted href=https://gethyas.com/terms/>Terms of Service</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=/js/bootstrap.c673c84373e66019f7895efc74b3b3b940071832aaa8a85e73218087d535e71b.js integrity="sha256-xnPIQ3PmYBn3iV78dLOzuUAHGDKqqKhecyGAh9U15xs="></script><script async src=/js/app.47c46b2840c2453168bad1c3330a87ccfe7430ff205663d3aca213c6293a838a.js integrity="sha256-R8RrKEDCRTFoutHDMwqHzP50MP8gVmPTrKITxik6g4o="></script><script async src=/js/flexsearch.b6f80717bc68cd38b6ded7a061f96a73896db6be17a6582f09a63a6040040919.js integrity="sha256-tvgHF7xozTi23tegYflqc4lttr4XplgvCaY6YEAECRk="></script><script async src=/js/search-modal.4e30271fef6fac86c3b4143167e9784bd3f7037ce1045d03a321e7e799e91476.js integrity="sha256-TjAnH+9vrIbDtBQxZ+l4S9P3A3zhBF0DoyHn55npFHY="></script></body></html>